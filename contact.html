<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Kampong</title>
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/all.min.css" />
    <link rel="stylesheet" href="css/slick.css" />
    <link rel="stylesheet" href="css/slick-theme.css" />
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,500&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="css/main.css" />

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="96x96" href="favicon/favicon-96x96.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png" />
    <link rel="manifest" href="favicon/manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="msapplication-TileImage" content="favicon/ms-icon-144x144.png" />
    <meta name="theme-color" content="#ffffff" />
</head>

<body>
    <div class="navigation">
        <div class="logo-container">
            <a href="index.html">
                <img src="./image/kampong-logo.png" />
            </a>
        </div>
        <div class="menu-btn">
            <i class="fas fa-bars"></i>
        </div>
        <div class="navigation-links">
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About Us</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </div>
    </div>
    <main>
        <div class="banner hover-banner animate-block">
            <h1 class="text-center">Contact Us</h1>
            <div class="container hover-container">
                <div class="hover-image">
                    <img class="banner-image" style="max-height: 500px; outline: 1rem solid white" src="https://images.pexels.com/photos/4831/hands-coffee-smartphone-technology.jpg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260" />
                </div>
            </div>
        </div>

        <div class="block-content container animate-block">
            <div class="contact-us d-flex flex-wrap justify-content-between">
                <div class="form col-12 col-lg-7">
                    <input id="contact_name" type="text" placeholder="Your Name" />
                    <input id="contact_email" type="text" placeholder="Your Email" />
                    <textarea id="contact_message" placeholder="Your Message" rows="7"></textarea>

                    <a class="submit-btn">
                        Submit
                        <img class="loading-icon" src="./image/loading.gif" />
                    </a>
                </div>
                <div class="contact-info col-12 col-lg-4">
                    <div class="contact-item item">
                        <i class="far fa-envelope"></i>
                        <div>
                            <a href="#">Support@kampong.com</a>
                            <p>Send us your query anytime!</p>
                        </div>
                    </div>

                    <div class="contact-item item">
                        <i class="far fa-envelope"></i>
                        <div>
                            <a href="#">Support@kampong.com</a>
                            <p>Send us your query anytime!</p>
                        </div>
                    </div>

                    <div class="contact-item item">
                        <i class="far fa-envelope"></i>
                        <div>
                            <a href="#">Support@kampong.com</a>
                            <p>Send us your query anytime!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container footer-container">
            <div class="footer-logo">
                <div class="logo-container">
                    <img src="./image/kampong-logo.png" />
                </div>
                <p>
                    Project Matchmaking platform. <br />
            for youths. <br />
            through interest.
          </p>
            </div>

            <div class="d-flex justify-content-between flex-wrap">
                <div class="footer-links">
                    <p class="label">Quick Links</p>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </div>

                <div class="footer-links">
                    <p class="label">Social Media</p>
                    <ul>
                        <li>
                            <a href="#">Instagram</a>
                        </li>
                        <li>
                            <a href="#">Facebook</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>
</body>
<script src="./js/jquery.min.js" type="text/javascript"></script>
<script src="./js/all.min.js" type="text/javascript"></script>
<script src="./js/bootstrap.min.js" type="text/javascript"></script>
<script src="./js/slick.min.js" type="text/javascript"></script>
<script src="./js/validator.js" type="text/javascript"></script>
<script src="./js/main.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/gh/jitbit/HtmlSanitizer@master/HtmlSanitizer.js"></script>
<script>
    $(document).ready(function() {
        $(".animate-block .banner-image").animate({
                opacity: 1.0,
                bottom: 0
            },
            800
        );

        $(".submit-btn").on("click", function() {
            console.log("clicked");
            $(".loading-icon").show();
            $(".submit-btn").addClass("loading");
            postreq();
        });

        $(window).scroll(function() {
            var windowLocation = $(window).scrollTop() + $(window).height();

            $(".animate-block .contact-info .item").each(function(i) {
                if (windowLocation > $(this).offset().top) {
                    $(this).animate({
                            right: 0
                        },
                        800
                    );
                }
            });

            $(".animate-block .step-item").each(function(i) {
                if (windowLocation > $(this).offset().top) {
                    $(this)
                        .delay(300)
                        .animate({
                                opacity: 1.0,
                                bottom: 0
                            },
                            800
                        );
                }
            });
        });
    });

    function postreq() {
        const name = HtmlSanitizer.SanitizeHtml($("#contact_name").val());
        const email = HtmlSanitizer.SanitizeHtml($("#contact_email").val());
        const message = HtmlSanitizer.SanitizeHtml($("#contact_message").val());

        $(".form input").removeClass("error");
        $(".form textarea").removeClass("error");
        $(".form .error-msg").remove();
        $(".form .success-msg").remove();

        const checkEmail = validate(email);
        if (name.length == 0) {
            $("#contact_name")
                .addClass("error")
                .after("<span class='error-msg'>invalid field</span>");
            $(".loading-icon").hide();
            $(".submit-btn").removeClass("loading");
            return;
        } else if (!checkEmail) {
            $("#contact_email")
                .addClass("error")
                .after("<span class='error-msg'>invalid field</span>");
            $(".loading-icon").hide();
            $(".submit-btn").removeClass("loading");

            return;
        } else if (message.length == 0) {
            $("#contact_message")
                .addClass("error")
                .after("<span class='error-msg'>invalid field</span>");
            $(".loading-icon").hide();
            $(".submit-btn").removeClass("loading");

            return;
        } else {
            const body = JSON.stringify({
                name: name,
                email: email,
                message: message
            });
            var xhttp = new XMLHttpRequest();
            xhttp.open(
                "POST",
                "https://us-central1-project-kampong.cloudfunctions.net/helloWorld",
                true
            );
            xhttp.setRequestHeader("Content-type", "application/json");
            xhttp.setRequestHeader("Access-Control-Allow-Origin", "*");
            xhttp.onload = function() {
                $(".loading-icon").hide();
                $(".submit-btn").removeClass("loading");
                if (xhttp.status != 200) {
                    $(".submit-btn").after(
                        "<span class='error-msg'>An error had occured, please try again later.</span>"
                    );
                } else {
                    $("#contact_name").val("");
                    $("#contact_email").val("");
                    $("#contact_message").val("");
                    $(".submit-btn").after(
                        "<span class='success-msg'>We appreciate you contacting team kampong!. We will get back in touch with you soon!</span>"
                    );
                }
            };
            console.log("sending");
            xhttp.send(body);
            return;
        }
    }
</script>

</html>